

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>Accessing the DOM in a Windows 8 WebView</title>
    <meta name="description" content="">

    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    

    <link rel="stylesheet" type="text/css" href="../assets/css/screen.css?v=44c55ef586">
    <link href="http://fonts.googleapis.com/css?family=Open+Sans:400,700" rel="stylesheet" type="text/css">

    <link rel="canonical" href="http://my-ghost-blog.com/accessing-the-dom-in-a-windows-8-webview/">
    <meta name="referrer" content="origin-when-cross-origin">
    
    <meta property="og:site_name" content="Sertaç Özercan">
    <meta property="og:type" content="article">
    <meta property="og:title" content="Accessing the DOM in a Windows 8 WebView">
    <meta property="og:description" content="I was recently working on a Windows 8 app that required accessing the DOM to retrieve certain elements from a website, such as images and links, since there wasn’t a feed to pull those information from. To access the DOM, you obviously need a webview in a C#/XAML">
    <meta property="og:url" content="http://my-ghost-blog.com/accessing-the-dom-in-a-windows-8-webview/">
    <meta property="article:published_time" content="2013-06-21T09:13:50.000Z">
    <meta property="article:modified_time" content="2013-06-21T09:37:47.000Z">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Accessing the DOM in a Windows 8 WebView">
    <meta name="twitter:description" content="I was recently working on a Windows 8 app that required accessing the DOM to retrieve certain elements from a website, such as images and links, since there wasn’t a feed to pull those information from. To access the DOM, you obviously need a webview in a C#/XAML">
    <meta name="twitter:url" content="http://my-ghost-blog.com/accessing-the-dom-in-a-windows-8-webview/">
    <meta name="twitter:label1" content="Written by">
    <meta name="twitter:data1" content="Sertaç Özercan">
    <meta name="twitter:site" content="@sozercan">
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "Sertaç Özercan",
        "logo": "http://my-ghost-blog.com/ghost/img/ghosticon.jpg"
    },
    "author": {
        "@type": "Person",
        "name": "Sertaç Özercan",
        "image": "//www.gravatar.com/avatar/b55d471041bacda59fdbe29c719a4f98?s=250&d=mm&r=x",
        "url": "http://my-ghost-blog.com/author/sozercan/",
        "sameAs": [
            "http://sertacozercan.com"
        ]
    },
    "headline": "Accessing the DOM in a Windows 8 WebView",
    "url": "http://my-ghost-blog.com/accessing-the-dom-in-a-windows-8-webview/",
    "datePublished": "2013-06-21T09:13:50.000Z",
    "dateModified": "2013-06-21T09:37:47.000Z",
    "description": "I was recently working on a Windows 8 app that required accessing the DOM to retrieve certain elements from a website, such as images and links, since there wasn’t a feed to pull those information from. To access the DOM, you obviously need a webview in a C#/XAML"
}
    </script>

    <meta name="generator" content="Ghost 0.9">
    <link rel="alternate" type="application/rss+xml" title="Sertaç Özercan" href="http://my-ghost-blog.com/rss/">

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">

    <link rel="stylesheet" type="text/css" href="../assets/css/prism.css?v=44c55ef586">
</head>

<body class="post-template">

    <div id="sidebar">
        <div id="sidebar-content" class="inner">
            
            <h2 class="blog-title"><a href="http://my-ghost-blog.com">Sertaç Özercan</a></h2>
            <h3 class="blog-description"></h3>

            <form id="search">
                <input id="search-field" placeholder="Search">
            </form>

            <div id="sidebar-links">
                <ul id="subscription-links">
                    <li><a target="_blank" href="http://my-ghost-blog.com/rss/"><i class="fa fa-rss"></i>Subscribe via RSS</a></li>
                    <!-- No support yet
                    <li><a target="_blank" href=" "><i class="fa fa-envelope"></i>Subscribe via email<a></li>
                    -->
                </ul>
                <ul id="navigation">
                        <li class="nav-home" role="presentation"><a href="../"><i class="fa fa-navicon"></i>Home</a></li>
    <li class="nav-projects" role="presentation"><a href="../projects/"><i class="fa fa-navicon"></i>Projects</a></li>
    <li class="nav-about" role="presentation"><a href="../about-me/"><i class="fa fa-navicon"></i>About</a></li>
    <li class="nav-publications" role="presentation"><a href="../publications/"><i class="fa fa-navicon"></i>Publications</a></li>

                </ul>
                <ul id="sidebar-external">
                    <li><a href="https://twitter.com/sozercan"><i class="fa fa-twitter"></i>Twitter</a></li>
<li><a href="https://github.com/sozercan"><i class="fa fa-github"></i>GitHub</a></li>
<li><a href="https://www.linkedin.com/in/sozercan"><i class="fa fa-linkedin"></i>LinkedIn</a></li>
<li><a target="_blank" href="mailto:sozercan@gmail.com"><i class="fa fa-envelope"></i>Contact</a></li>                </ul>
            </div>

            <footer class="site-footer">
                <section class="copyright">© 2016 <a href="mailto:sozercan@gmail.com">Sertaç Özercan</a></section>
                <section class="poweredby">
                    <i class="icon-ghost"></i><a href="https://ghost.org">Ghost</a> -
                    <a href="https://github.com/dlecina/StayPuft">StayPuft theme</a>
                </section>
            </footer>
        </div>
    </div>

    <main>
        <div class="main-inner">
            <section id="results"></section>
            


    <article class="post">

        <header class="post-header">

            <h1 class="post-title">Accessing the DOM in a Windows 8 WebView</h1>
            
            <section class="post-meta">
                <span class="post-time">
                    <i class="fa fa-calendar"></i>
                    <time datetime="2013-06-21" class="timeago">3 years ago</time>
                    <time datetime="2013-06-21" class="fulldate">June 21st, 2013</time>
                </span>
                
            </section>
        </header>

        <section class="post-content">
            <p>I was recently working on a Windows 8 app that required accessing the DOM to retrieve certain elements from a website, such as images and links, since there wasn’t a feed to pull those information from.</p>

<p>To access the DOM, you obviously need a webview in a C#/XAML application. However, that webview doesn’t have to be visible. If you define the webview as <em>Visibility=”Collapsed”</em>, it will still work without actually displaying anything.</p>

<p>For example (in XAML):</p>

<p><code>&lt;WebView x:Name="webView" Visibility="Collapsed" Height="1" Width="1" /&gt;</code></p>

<p>After adding the webView, you need to navigate to a page and subscribe to a LoadCompleted handler when its finished loading (in .cs code).  </p>

<pre><code>           &lt;br&gt;&lt;/br&gt;
                webView.LoadCompleted += webView_LoadCompleted;&lt;br&gt;&lt;/br&gt;
                webView.Navigate(new Uri("http://sertacozercan.com"));```

In the webView_LoadCompleted function, if you need to fire [ScriptNotify](http://msdn.microsoft.com/en-us/library/windows/apps/windows.ui.xaml.controls.webview.allowedscriptnotifyuris) events, you need to add the page to the list of allowedUris.
</code></pre>

<pre><code>            List&lt;Uri&gt; allowedUris = new List&lt;Uri&gt;();&lt;br&gt;&lt;/br&gt;
            allowedUris.Add(new Uri("http://sertacozercan.com""));&lt;br&gt;&lt;/br&gt;
            webView.AllowedScriptNotifyUris = allowedUris;```
</code></pre>

<p>To get access to the DOM and retrieve values, you need to eval the arguments passed to webView.InvokeScript like below to get the title of the page.</p>

<pre><code>                string[] args = { "document.title;" };&lt;br&gt;&lt;/br&gt;
                string foo = webView.InvokeScript("eval", args);```

Arguments can be used to get any element, such as children count, and you can iterate on that.  
 One important thing to note is the .toString() function when getting the count. You need to convert this back to a numeric value if you want to use it as such.
</code></pre>

<pre><code>            string[] args = { "document.getElementsByClassName('className')[0].childElementCount.toString();" };&lt;br&gt;&lt;/br&gt;
            string foo = webView.InvokeScript("eval", args);&lt;br&gt;&lt;/br&gt;
            Int32.TryParse(foo, out childCount);```
</code></pre>

<p>To retrieve and save images locally, you can use the following code: (you can iterate on the childCount and get all images with certain class names, for example)  </p>

<pre><code>&lt;br&gt;&lt;/br&gt;  
Uri source = new Uri(imgSrc);&lt;br&gt;&lt;/br&gt;  
StorageFile destinationFile;&lt;br&gt;&lt;/br&gt;  
try&lt;br&gt;&lt;/br&gt;  
{&lt;br&gt;&lt;/br&gt;
    destinationFile = await ApplicationData.Current.LocalFolder.CreateFileAsync("pic.jpg", CreationCollisionOption.ReplaceExisting);&lt;br&gt;&lt;/br&gt;
}&lt;br&gt;&lt;/br&gt;
catch (FileNotFoundException ex)&lt;br&gt;&lt;/br&gt;  
{&lt;br&gt;&lt;/br&gt;
    return;&lt;br&gt;&lt;/br&gt;
}&lt;br&gt;&lt;/br&gt;
BackgroundDownloader downloader = new BackgroundDownloader();&lt;br&gt;&lt;/br&gt;  
DownloadOperation download = downloader.CreateDownload(source, destinationFile);&lt;br&gt;&lt;/br&gt;  
await download.StartAsync();&lt;br&gt;&lt;/br&gt;  
ResponseInformation response = download.GetResponseInformation();&lt;br&gt;&lt;/br&gt;```  
            
 After that, if you have a listView, flipView etc, you can add those images or texts you retrieved from the web page to populate your list. Something like this for example:  
</code></pre>

<p><br> <br>
                flipViewData.Items.Add(new FlipViewDataItem("item-"+i,<br>
                    urlHref,<br>
                    destinationFile.Path<br>
                    ));<br>```</p>
        </section>

        <footer class="post-footer">


                <figure class="author-image">
                    <a class="img" href="../author/sozercan/" style="background-image: url(http://www.gravatar.com/avatar/b55d471041bacda59fdbe29c719a4f98?s&amp;)"><span class="hidden">Sertaç Özercan's Picture</span></a>
                </figure>

                <section class="author">
                    <h4><a href="../author/sozercan/">Sertaç Özercan</a></h4>

                        <p>Read <a href="../author/sozercan/">more posts</a> by this author.</p>
                    <div class="author-meta">
                        <span class="author-location icon-location">San Francisco, CA</span>
                        <span class="author-link icon-link"><a href="http://sertacozercan.com">http://sertacozercan.com</a></span>
                    </div>
                </section>


            <section class="share">
                <h4>Share this post</h4>
                <div class="share-icons">
                    <a class="fa fa-twitter-square" href="https://twitter.com/intent/tweet?text=Accessing%20the%20DOM%20in%20a%20Windows%208%20WebView&amp;url=http://my-ghost-blog.com/accessing-the-dom-in-a-windows-8-webview/" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
                        <span class="hidden">Twitter</span>
                    </a>
                    <a class="fa fa-facebook-square" href="https://www.facebook.com/sharer/sharer.php?u=http://my-ghost-blog.com/accessing-the-dom-in-a-windows-8-webview/" onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
                        <span class="hidden">Facebook</span>
                    </a>
                    <a class="fa fa-google-plus-square" href="https://plus.google.com/share?url=http://my-ghost-blog.com/accessing-the-dom-in-a-windows-8-webview/" onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
                        <span class="hidden">Google+</span>
                    </a>
                </div>
            </section>

        </footer>

        <section class="post-comments">
            <div id="disqus_thread"></div>
            <script type="text/javascript">
                /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
                var disqus_shortname = 'sozercan'; // required: replace example with your forum shortname
                /* * * DON'T EDIT BELOW THIS LINE * * */
                (function() {
                    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                })();
            </script>
            <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
            <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
        </section>


    </article>


        </div>
    </main>

    

    <script type="text/javascript" src="https://code.jquery.com/jquery-1.11.3.min.js"></script>
    <script type="text/javascript" src="../assets/js/jquery.fitvids.js?v=44c55ef586"></script>
    <script type="text/javascript" src="../assets/js/index.js?v=44c55ef586"></script>
    <script type="text/javascript" src="../assets/js/prism-loader.js?v=44c55ef586"></script>
    <script type="text/javascript" src="../assets/js/prism.js?v=44c55ef586"></script>
    <script src="../assets/js/jquery.ghostHunter.min.js?v=44c55ef586"></script>
    <script>
        $("#search-field").ghostHunter({
            rss : "http://my-ghost-blog.com/rss/",
            results : "#results",
            onKeyUp : true,
            zeroResultsInfo : false
        });
    </script>
</body>

